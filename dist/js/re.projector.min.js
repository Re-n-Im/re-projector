var ReProjector=function(opt){var INTERVAL_TIMEOUT_HIDE_CONTROLS=3,DEFAULT_ACCENT_COLOR="#555",DEFAULT_DARK_COLOR="#282828",DEFAULT_STYLE="dark",ESCAPE_KEY=27,ARROW_LEFT_KEY=37,ARROW_UP_KEY=38,ARROW_RIGHT_KEY=39,ARROW_DOWN_KEY=40,SPACE_KEY=32,F_KEY=102,H_KEY=104,I_KEY=105,F_CYR_KEY=1092,I_CYR_KEY=1080,H_CYR_KEY=1093,DIGIT_1_KEY=49,DIGIT_2_KEY=50,DIGIT_3_KEY=51,This=this,Options={bKeyboardChangeTheme:null,bKeyboardToggleExif:null,bKeyboardNavigation:null,bKeyboardToggleControls:null,bMouseWheelNavigation:null,bSwipeNavigation:null,iTimerFadeOutControls:null,sToggle:null,bHideCursor:null,bShowNextOnClick:null,bKeyboardChangeTheme:!0,bKeyboardToggleExif:!0,bKeyboardNavigation:!0,bKeyboardToggleControls:!0,bMouseWheelNavigation:!0,bSwipeNavigation:!0,iTimerFadeOutControls:0,sToggle:!0,bHideCursor:!0,bShowNextOnClick:!0},Lang={exposurePrograms:null,months:null,units:null,translate:null},UserLang={exposurePrograms:{},months:{},units:{},translate:null};Lang.exposurePrograms={0:"Not defined",1:"Manual",2:"Normal program",3:"Aperture priority",4:"Shutter priority",5:"Creative program",6:"Action program",7:"Portrait mode",8:"Landscape mode"},Lang.months={1:"Jan",2:"Feb",3:"Mar",4:"Apr",5:"May",6:"Jun",7:"Jul",8:"Aug",9:"Sep",10:"Oct",11:"Nov",12:"Dec"},Lang.units={seconds:"s",milimeters:"mm"},Lang.translate=UserLang.translate=function(n,e){return void 0!==UserLang[n][e]?UserLang[n][e]:Lang[n][e]};var Inner={};return Inner.oBody=$("body"),Inner.oMetaThemeColor=null,Inner.oCanvas=null,Inner.oCurr=null,Inner.oNext=null,Inner.oPrev=null,Inner.iIntervalHideArrowsProjector=null,Inner.bTouchAndMove=!0,Inner.changePhotographCallback=null,Inner.openCallback=null,Inner.closeCallback=null,Inner.showControlsCallback=null,Inner.hideControlsCallback=null,Inner.canvasClickCallback=null,Inner.canvasClickHandler=function(){var n=!0;Inner.canvasClickCallback&&(n=Inner.canvasClickCallback.call()),n&&Inner.closeReProjector.call()},Inner.canvasImageClickHandler=function(n){if(n.stopPropagation(),Inner.bTouchAndMove)return!1;"click"==Options.sToggle?Inner.toggleVisibilityOfProjectionControls.call():(Inner.areProjectionControlsVisible.call()||Inner.showProjectionControls.call(),Options.bShowNextOnClick&&Inner.previewNext.call())},Inner.canvasImageMousedownHandler=function(n){Inner.bTouchAndMove=!1},Inner.canvasImageMousemoveHandler=function(n){!1===Inner.bTouchAndMove&&(Inner.bTouchAndMove=!0)},Inner.canvasImageMouseupHandler=function(n){Inner.bTouchAndMove=null},Inner.hideProjectionControls=function(){Inner.oCanvas.hasClass("hide-projection-controls")||Inner.oCanvas.addClass("hide-projection-controls"+("click"!=Options.sToggle&&Options.bHideCursor?"":" leave-cursor-visible")),"function"==typeof Inner.hideControlsCallback&&Inner.hideControlsCallback.call()},Inner.showProjectionControls=function(){Inner.oCanvas.hasClass("hide-projection-controls")&&Inner.oCanvas.removeClass("hide-projection-controls"+("click"!=Options.sToggle&&Options.bHideCursor?"":" leave-cursor-visible")),"function"==typeof Inner.showControlsCallback&&Inner.showControlsCallback.call()},Inner.areProjectionControlsVisible=function(){return!Inner.oCanvas.hasClass("hide-projection-controls")},Inner.triggerProjectionControlsVisibility=function(){This.isVisible()&&!Inner.isTouchDevice.call()&&"mousemove"==Options.sToggle&&(Inner.showProjectionControls.call(),Inner.resetIntervalHideProjectorControls.call())},Inner.resetIntervalHideProjectorControls=function(){Inner.iIntervalHideArrowsProjector&&clearTimeout(Inner.iIntervalHideArrowsProjector),Inner.iIntervalHideArrowsProjector=setTimeout(function(){Inner.hideProjectionControls.call()},1e3*(Options.iTimerFadeOutControls||INTERVAL_TIMEOUT_HIDE_CONTROLS))},Inner.getNewExifContent=function(){var oPd=$(this),aExifParams=[],oContent=$("<div/>").addClass("exif-info-box");if(oPd.data("camera-model")){if(aExifParams=[{title:"Model",image:"/images/exif-info/camera.svg",value:oPd.data("camera-model").toLowerCase().replace(/\b([a-zA-Z])/g,function(n){return n.toUpperCase()})},{title:"Length",image:"/images/exif-info/length.svg",value:null},{title:"F number",image:"/images/exif-info/aperture.svg",value:null},{title:"ISO",image:"/images/exif-info/iso.svg",value:oPd.data("camera-iso")},{title:"Exposure",image:"/images/exif-info/exposure.svg",value:null},{title:"Program",image:"/images/exif-info/mode.svg",value:Lang.translate.call(null,"exposurePrograms",oPd.data("camera-program"))},{title:"Date",image:"/images/exif-info/date.svg",value:null}],oPd.data("camera-flength")&&(aExifParams[1].value=eval(oPd.data("camera-flength"))+" "+Lang.translate.call(null,"units","milimeters")),oPd.data("camera-aperture")&&(aExifParams[2].value="Æ’/"+eval(oPd.data("camera-aperture"))),oPd.data("camera-exposure")&&oPd.data("camera-exposure").match(/\//)){var aExp=oPd.data("camera-exposure").split("/"),sExp=oPd.data("camera-exposure");aExp[0]<aExp[1]&&10==aExp[0]?sExp="1/"+aExp[1]/10:aExp[0]>aExp[1]&&10==aExp[1]?sExp=aExp[0]/10:aExp[0]>aExp[1]&&1==aExp[1]?sExp=aExp[0]:aExp[0]==aExp[1]&&(sExp=1),aExifParams[4].value=sExp+" "+Lang.translate.call(null,"units","seconds")}if(oPd.data("camera-date")){var aOr=oPd.data("camera-date").split(/[- :]/),dOr=new Date(aOr[0],aOr[1]-1,aOr[2],aOr[3],aOr[4],aOr[5]),sOr=dOr.getDate()+" "+Lang.translate.call(null,"months",dOr.getMonth())+" "+dOr.getFullYear();aExifParams[6].value=sOr}for(var i=0;aExifParams.length>i;++i)aExifParams[i].value&&oContent.append($("<div/>").addClass("exif-record").append($("<em/>").css({backgroundImage:'url( "'+aExifParams[i].image+'" )'})).append($("<strong/>").text(aExifParams[i].value)))}return oContent.is(":empty")?null:oContent},Inner.getNewDescriptionContent=function(){var n=$(this),e=$("<div/>").addClass("description-info-box");if(void 0!==n.data("title")&&""!=n.data("title")||void 0!==n.data("description")&&""!=n.data("description")){var o=$("<div/>").addClass("photograph-title").appendTo(e);return""!=n.data("title")&&o.append($("<strong/>").addClass("info-photograph-text").text(n.data("title"))),""!=n.data("description")&&o.append($("<small/>").addClass("info-photograph-text").text(n.data("description"))),e}return null},Inner.swipeHandler=function(n,e,o,t,r,a){if(n.preventDefault(),n.stopImmediatePropagation(),!Inner.isZoomed.call()&&Options.bSwipeNavigation)switch(e){case"left":Inner.previewNext.call();break;case"right":Inner.previewPrev.call()}return!1},Inner.documentMousemoveHandler=function(n){Inner.triggerProjectionControlsVisibility.call()},Inner.documentKeypressHandler=function(n){var e=n.which||n.keyCode;!This.isVisible()||e!=I_KEY&&e!=F_KEY&&e!=H_KEY&&e!=I_CYR_KEY&&e!=F_CYR_KEY&&e!=H_CYR_KEY&&e!=DIGIT_1_KEY&&e!=DIGIT_2_KEY&&e!=DIGIT_3_KEY||(e==I_KEY||e==I_CYR_KEY?Options.bKeyboardToggleExif&&Inner.toggleExifInfoCont.call():e==F_KEY||e==F_CYR_KEY?Options.bKeyboardNavigation&&Inner.fullscreenTogglerHandler.call():e==H_KEY||e==H_CYR_KEY?Options.bKeyboardToggleControls&&("mousemove"==Options.sToggle?Inner.areProjectionControlsVisible.call()?Inner.hideProjectionControls.call():Inner.triggerProjectionControlsVisibility.call():Inner.areProjectionControlsVisible.call()?Inner.hideProjectionControls.call():Inner.showProjectionControls.call()):e==DIGIT_1_KEY?Options.bKeyboardChangeTheme&&Inner.changeStyleColor.call(null,"dark"):e==DIGIT_2_KEY?Options.bKeyboardChangeTheme&&Inner.changeStyleColor.call(null,"light"):e==DIGIT_3_KEY&&Options.bKeyboardChangeTheme&&Inner.changeStyleColor.call(null,"accent"))},Inner.documentKeydownHandler=function(n){var e=n.which||n.keyCode;This.isVisible()&&(ARROW_LEFT_KEY<=e&&e<=ARROW_DOWN_KEY||e==ESCAPE_KEY||e==SPACE_KEY)&&(n.stopPropagation(),n.preventDefault(),e==ARROW_LEFT_KEY||e==ARROW_UP_KEY||e==SPACE_KEY&&n.shiftKey?Options.bKeyboardNavigation&&Inner.previewPrev.call():e==ARROW_RIGHT_KEY||e==ARROW_DOWN_KEY||e==SPACE_KEY?Options.bKeyboardNavigation&&Inner.previewNext.call():e==ESCAPE_KEY&&Options.bKeyboardNavigation&&(Inner.isSettingsContOpened.call()?Inner.closeSettingsCont.call():Inner.closeReProjector.call()))},Inner.imageLinkClickHandler=function(n){return n.preventDefault(),This.preview($(this)),!1},Inner.createCookie=function(n,e,o){if(o){var t=new Date;t.setTime(t.getTime()+24*o*60*60*1e3);var r="; expires="+t.toGMTString()}else r="";document.cookie=n+"="+e+r+"; path=/"},Inner.readCookie=function(n){for(var e=n+"=",o=document.cookie.split(";"),t=0;t<o.length;t++){for(var r=o[t];" "==r.charAt(0);)r=r.substring(1,r.length);if(0==r.indexOf(e))return r.substring(e.length,r.length)}return null},Inner.eraseCookie=function(n){Inner.createCookie.call(null,n,"",-1)},Inner.mouseWheelHandler=function(){return function(n){if(Options.bMouseWheelNavigation){n=window.event||n;var e=!(Math.max(-1,Math.min(1,n.wheelDelta||-n.detail))<0);return e?Inner.previewPrev.call():Inner.previewNext.call(),e}}},Inner.isZoomed=function(){return window.innerWidth!=window.outerWidth},Inner.isTouchDevice=function(){try{return document.createEvent("TouchEvent"),!0}catch(n){return!1}},Inner.launchIntoFullscreen=function(n){n.requestFullscreen?n.requestFullscreen():n.mozRequestFullScreen?n.mozRequestFullScreen():n.webkitRequestFullscreen?n.webkitRequestFullscreen():n.msRequestFullscreen&&n.msRequestFullscreen()},Inner.exitFullscreen=function(){document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen&&document.webkitExitFullscreen()},Inner.oFullscreenElement=document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement,Inner.oFullscreenEnabled=document.fullscreenEnabled||document.mozFullScreenEnabled||document.webkitFullscreenEnabled,Inner.inFullscreen=function(){return document.isFullscreen,document.webkitIsFullscreen||document.mozFullScreen||void 0!==document.msFullscreenElement},Inner.settingsProjectionContClickHandler=function(n){n.stopPropagation()},Inner.settingsProjectionButtonClickHandler=function(n){$(this).parent().toggleClass("opened")},Inner.closeProjectionButton=function(n){n.stopPropagation(),Inner.closeReProjector.call()},Inner.nextPhotographProjectionControlClickHandler=function(n){return n.stopPropagation(),Inner.previewNext.call(),Inner.triggerProjectionControlsVisibility.call(),!1},Inner.prevPhotographProjectionControlClickHandler=function(n){return n.stopPropagation(),Inner.previewPrev.call(),Inner.triggerProjectionControlsVisibility.call(),!1},Inner.settingsProjectionBackgroundButtonClickHandler=function(n){var e=$(this);e.parent().find(".settings-projection-background-button").removeClass("active"),e.addClass("active"),Inner.changeStyleColor.call(null,e.data("style"))},Inner.settingsProjectionFullscreenButtonClickHandler=function(n){Inner.fullscreenTogglerHandler.call()},Inner.photographExifInfoButtonClickHandler=function(n){$(this).parent().toggleClass("opened")},Inner.photographExifInfoClickHandler=function(n){return n.stopPropagation(),!1},Inner.photographDescriptionInfoClickHandler=function(n){return n.stopPropagation(),!1},Inner.openReProjector=function(e){return Inner.oCanvas.addClass("preload"),Inner.oBody.addClass("re-projection"),Inner.oCanvas.stop().addClass("opened").animate({opacity:1},300,function(n){"function"==typeof e&&e.call()}),Inner.triggerProjectionControlsVisibility.call(),"function"==typeof Inner.openCallback&&Inner.openCallback.call(),"function"==typeof history.pushState&&"ReProjectorOpened"!=history.state&&history.pushState("ReProjectorOpened",null,null),This},Inner.closeReProjector=function(e){return Inner.oBody.removeClass("re-projection"),Inner.oCanvas.stop().animate({opacity:0},300,function(n){Inner.blankProjectorScreen.call(),Inner.resetStyleColor.call(),Inner.oCanvas.removeClass("opened preload"),"function"==typeof e&&e.call()}),This.exitFullscreen(),Inner.closeSettingsCont.call(),"function"==typeof Inner.closeCallback&&Inner.closeCallback.call(),"function"==typeof history.pushState&&"ReProjectorOpened"==history.state&&history.back(),This},Inner.setStyleColor=function(){if(This.isVisible()){var n="";if(Inner.oCanvas.hasClass("accent")){var e=This.getCurrentAccentColor();Inner.oCanvas.removeClass("light dark").css({backgroundColor:e}),n=e}else Inner.oCanvas.hasClass("dark")?(Inner.oCanvas.removeClass("light accent"),n=DEFAULT_DARK_COLOR):Inner.oCanvas.hasClass("light")&&(Inner.oCanvas.removeClass("accent dark"),n=Inner.oMetaThemeColor.data("content"));Inner.oMetaThemeColor.attr("content",n)}return This},Inner.resetStyleColor=function(){return Inner.oMetaThemeColor.attr("content",Inner.oMetaThemeColor.data("content")),This},Inner.previewNext=function(){return Inner.blankProjectorScreen.call(),Inner.clearPhotographInfo.call(),This.preview(Inner.oNext),setTimeout(function(){},100),This},Inner.previewPrev=function(){return Inner.blankProjectorScreen.call(),Inner.clearPhotographInfo.call(),This.preview(Inner.oPrev),setTimeout(function(){},100),This},Inner.blankProjectorScreen=function(){return Inner.oCanvas.removeClass("loaded"),This},Inner.rewritePhotographInfo=function(n){var e=This.getCurrentLink(),o=Inner.getNewExifContent.call(e),t=Inner.getNewDescriptionContent.call(e),r=Inner.oCanvas.find(".photograph-exif-info"),a=Inner.oCanvas.find(".photograph-description-info");return r.find(".exif-info-box").remove(),o?r.removeClass("empty").append(o):r.addClass("empty"),a.find(".description-info-box").remove(),t?a.removeClass("empty").append(t):a.addClass("empty"),This},Inner.clearPhotographInfo=function(){return Inner.oCanvas.find(".photograph-exif-info .exif-info-box").remove(),This},Inner.setPhotographLinks=function(n){var e=$(opt.selector);return Inner.oCurr=n,Inner.oNext=e.index(n)!=e.length-1?e.eq(e.index(n)+1):e.eq(0),Inner.oPrev=0!=e.index(n)?e.eq(e.index(n)-1):e.eq(e.length-1),This},Inner.changeStyleColor=function(n){return This.setClasses(["light dark accent",n]),Inner.setStyleColor.call(),Inner.createCookie.call(null,"projector-background",n),This},Inner.fullscreenTogglerHandler=function(){return This.checkIfFullscreen()?This.exitFullscreen():This.expandToFullscreen(),This},Inner.isSettingsContOpened=function(){return Inner.oCanvas.find(".settings-projection-cont").is(".opened")},Inner.openSettingsCont=function(){return Inner.oCanvas.find(".settings-projection-cont").addClass("opened"),This},Inner.closeSettingsCont=function(){return Inner.oCanvas.find(".settings-projection-cont").removeClass("opened"),This},Inner.setShowControlsCallback=function(n){return Inner.showControlsCallback=n,This},Inner.setHideControlsCallback=function(n){return Inner.hideControlsCallback=n,This},Inner.isExifInfoContOpened=function(){return Inner.oCanvas.find(".photograph-exif-info").is(".opened")},Inner.openExifInfoCont=function(){return Inner.oCanvas.find(".photograph-exif-info").addClass("opened"),This},Inner.closeExifInfoCont=function(){return Inner.oCanvas.find(".photograph-exif-info").removeClass("opened"),This},Inner.toggleExifInfoCont=function(){return Inner.isExifInfoContOpened.call()?Inner.closeExifInfoCont.call():Inner.openExifInfoCont.call(),This},Inner.toggleVisibilityOfProjectionControls=function(){"click"==Options.sToggle?Inner.areProjectionControlsVisible.call()?Inner.hideProjectionControls.call():Inner.showProjectionControls.call():"mousemove"==Options.sToggle&&Inner.triggerProjectionControlsVisibility.call()},this.close=function(){return Inner.closeReProjector.call(),this},this.preview=function(n){if(""!=$(n).attr("data-reprojector-index")){var o=$(n).attr("href"),t=function(){"function"==typeof Inner.changePhotographCallback&&Inner.changePhotographCallback.call(Inner.oCurr),Inner.oCanvas.addClass("loaded")},e=function(n){This.getCurrentLink();var e=$("<img/>").one("load",t).attr("src",o).appendTo(Inner.oCanvas);Inner.oCanvas.find("img:not(:last-child)").length&&Inner.oCanvas.find("img:not(:last-child)").remove(),Inner.setStyleColor.call(),e[0].complete&&t()};Inner.setPhotographLinks.call(null,n),this.isVisible()?e.call():Inner.openReProjector.call(null,e),Inner.rewritePhotographInfo.call()}return this},this.setClasses=function(n){return Inner.oCanvas.removeClass(n[0]).addClass(n[1]),this},this.isVisible=function(){return 0<Inner.oCanvas.css("zIndex")},this.getCurrentLink=function(){return Inner.oCurr},this.setOpenCallback=function(n){return Inner.openCallback=n,this},this.setCloseCallback=function(n){return Inner.closeCallback=n,this},this.setChangePhotographCallback=function(n){return Inner.changePhotographCallback=n,this},this.setCanvasClickCallback=function(n){return Inner.canvasClickCallback=n,this},this.expandToFullscreen=function(n){return Inner.launchIntoFullscreen.call(null,document.documentElement),"function"==typeof n&&n.call(),this},this.exitFullscreen=function(n){return Inner.exitFullscreen.call(),"function"==typeof n&&n.call(),this},this.checkIfFullscreen=function(){return Inner.inFullscreen.call()},this.getCurrentAccentColor=function(){var n=this.getCurrentLink().data("accent-color");return n&&""!=n?n:DEFAULT_ACCENT_COLOR},function(){if(Inner.oCanvas=$("<div/>").addClass("projector-canvas").append($("<div/>").addClass("loader-cont").append($("<span/>").addClass("gear-big")).append($("<span/>").addClass("gear-small"))).append($("<div/>").addClass("prev-photograph projection-control").click(Inner.prevPhotographProjectionControlClickHandler)).append($("<div/>").addClass("next-photograph projection-control").click(Inner.nextPhotographProjectionControlClickHandler)).append($("<div/>").addClass("close-projection-button").click(Inner.closeProjectionButton)).append($("<div/>").addClass("settings-projection-cont").append($("<div/>").addClass("settings-projection-button").click(Inner.settingsProjectionButtonClickHandler)).append($("<div/>").attr("data-style","dark").addClass("settings-projection-background-button spb-dark")).append($("<div/>").attr("data-style","light").addClass("settings-projection-background-button spb-light")).append($("<div/>").attr("data-style","accent").addClass("settings-projection-background-button spb-accent")).append($("<div/>").addClass("settings-projection-fullscreen-button")).click(Inner.settingsProjectionContClickHandler).on("click",".settings-projection-background-button",Inner.settingsProjectionBackgroundButtonClickHandler).on("click",".settings-projection-fullscreen-button",Inner.settingsProjectionFullscreenButtonClickHandler)).append($("<div/>").addClass("photograph-exif-info").append($("<div/>").addClass("photograph-exif-info-button").click(Inner.photographExifInfoButtonClickHandler)).click(Inner.photographExifInfoClickHandler)).append($("<div/>").addClass("photograph-description-info").click(Inner.photographDescriptionInfoClickHandler)).appendTo("body").click(Inner.canvasClickHandler).on("click","img",Inner.canvasImageClickHandler).on("mousedown","img",Inner.canvasImageMousedownHandler).on("mousemove","img",Inner.canvasImageMousemoveHandler).on("mouseup","img",Inner.canvasImageMouseupHandler).swipe({swipeLeft:Inner.swipeHandler,swipeRight:Inner.swipeHandler}),(t=Inner.readCookie.call(null,"projector-background"))?Inner.oCanvas.addClass(t):Inner.oCanvas.addClass(DEFAULT_STYLE),$('meta[name="theme-color"]').length?(Inner.oMetaThemeColor=$('meta[name="theme-color"]'),Inner.oMetaThemeColor.attr("data-content",Inner.oMetaThemeColor.attr("content"))):Inner.oMetaThemeColor=$("<meta/>",{name:"theme-color",content:"","data-content":""}).appendTo("html head"),!opt||!opt.selector||"string"!=typeof opt.selector)throw new Error("Selector is a must!");if($(opt.selector).each(function(n,e){$(e).attr("data-reprojector-index",n)}),opt.projectionControls){if(null==opt.projectionControls.settings||!0===opt.projectionControls.settings?Inner.oCanvas.find(".settings-projection-cont").removeClass("invisible"):Inner.oCanvas.find(".settings-projection-cont").addClass("invisible"),null==opt.projectionControls.close||!0===opt.projectionControls.close?Inner.oCanvas.find(".close-projection-button").removeClass("invisible"):Inner.oCanvas.find(".close-projection-button").addClass("invisible"),null==opt.projectionControls.prevNext||!0===opt.projectionControls.prevNext?Inner.oCanvas.find(".prev-photograph.projection-control, .next-photograph.projection-control").removeClass("invisible"):Inner.oCanvas.find(".prev-photograph.projection-control, .next-photograph.projection-control").addClass("invisible"),null==opt.projectionControls.exif||!0===opt.projectionControls.exif?Inner.oCanvas.find(".photograph-exif-info").removeClass("invisible"):Inner.oCanvas.find(".photograph-exif-info").addClass("invisible"),null==opt.projectionControls.description||!0===opt.projectionControls.description?Inner.oCanvas.find(".photograph-description-info").removeClass("invisible"):Inner.oCanvas.find(".photograph-description-info").addClass("invisible"),opt.projectionControls.keyboard&&(null==opt.projectionControls.keyboard.theme||!0===opt.projectionControls.keyboard.theme?Options.bKeyboardChangeTheme=!0:Options.bKeyboardChangeTheme=!1,null==opt.projectionControls.keyboard.exif||!0===opt.projectionControls.keyboard.exif?Options.bKeyboardToggleExif=!0:Options.bKeyboardToggleExif=!1,null==opt.projectionControls.keyboard.navigation||!0===opt.projectionControls.keyboard.navigation?Options.bKeyboardNavigation=!0:Options.bKeyboardNavigation=!1,null==opt.projectionControls.keyboard.toggleControls||!0===opt.projectionControls.keyboard.toggleControls?Options.bKeyboardToggleControls=!0:Options.bKeyboardToggleControls=!1),opt.projectionControls.mouse&&(null==opt.projectionControls.mouse.wheel||!0===opt.projectionControls.mouse.wheel?Options.bMouseWheelNavigation=!0:Options.bMouseWheelNavigation=!1,null==opt.projectionControls.mouse.swipe||!0===opt.projectionControls.mouse.swipe?Options.bSwipeNavigation=!0:Options.bSwipeNavigation=!1,null!=opt.projectionControls.mouse.timeout&&parseFloat(opt.projectionControls.mouse.timeout)&&(Options.iTimerFadeOutControls=opt.projectionControls.mouse.timeout)),null!=opt.projectionControls.toggle)switch(opt.projectionControls.toggle){case"mousemove":Options.sToggle="mousemove";break;case"click":Options.sToggle="click"}if(null==opt.projectionControls.hideCursor||!0===opt.projectionControls.hideCursor?Options.bHideCursor=!0:Options.bHideCursor=!1,null==opt.projectionControls.showNextOnClick||!0===opt.projectionControls.showNextOnClick?Options.bShowNextOnClick=!0:Options.bShowNextOnClick=!1,null!=opt.translations&&"object"==typeof opt.translations)for(var n in UserLang)if(null!=opt.translations[n]&&"object"==typeof opt.translations[n]&&"object"==typeof UserLang[n])for(var e in opt.translations[n])UserLang[n][e]=opt.translations[n][e];"function"==typeof opt.openCallback&&this.setOpenCallback(opt.openCallback),"function"==typeof opt.closeCallback&&this.setCloseCallback(opt.closeCallback),"function"==typeof opt.changePhotographCallback&&this.setChangePhotographCallback(opt.changePhotographCallback),"function"==typeof opt.canvasClickCallback&&this.setCanvasClickCallback(opt.canvasClickCallback)}$(document).mousemove(Inner.documentMousemoveHandler).keypress(Inner.documentKeypressHandler).keydown(Inner.documentKeydownHandler).on("click",opt.selector,Inner.imageLinkClickHandler),document.addEventListener&&(Inner.oCanvas[0].addEventListener("mousewheel",Inner.mouseWheelHandler.call(null),!1),Inner.oCanvas[0].addEventListener("DOMMouseScroll",Inner.mouseWheelHandler.call(null),!1)),"function"==typeof history.pushState&&(window.onpopstate=function(){This.isVisible()&&Inner.closeReProjector.call()})}.call(this),this};